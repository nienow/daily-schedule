const D=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],v=["January","February","March","April","May","June","July","August","September","October","November","December"],u=()=>{const e=document.forms.generate,t=new Date(`${e.startDate.value}T00:00:00`),a=new Date(`${e.endDate.value}T00:00:00`),d=[e.sunday.checked,e.monday.checked,e.tuesday.checked,e.wednesday.checked,e.thursday.checked,e.friday.checked,e.saturday.checked],o=[];return e.prefill?.forEach(c=>{o.push(c.value)}),{startDate:t,endDate:a,prefill:o,activeDays:d}},l=()=>{const e=u();e.startDate=e.startDate.toISOString().split("T")[0],e.endDate=e.endDate.toISOString().split("T")[0];const t=new URLSearchParams(e).toString();window.history.pushState(e,null,"?"+t)},m=()=>{const{startDate:e,endDate:t,prefill:a,activeDays:d}=u(),o=Math.round((t.getTime()-e.getTime())/864e5),n=8.5/a.length;let s="";for(let i=0;i<o+1;i++){const r=new Date(e.getTime()+864e5*i);if(!d[r.getDay()])continue;const y=`<div class="title">${D[r.getDay()]}, ${v[r.getMonth()]} ${r.getDate()}</div>`,p=a.map(g=>`<div class="line" style="height: ${n}in"><div class="txt">${g}</div></div>`),h=`<div class="page">${y}${p.join("")}</div>`;s+=h}return s};function f(e){e.preventDefault();const t=u();window.history.pushState({params:t},null);const a=m();document.getElementById("output").contentWindow.document.body.innerHTML=a,document.getElementById("output").parentElement.style.visibility="visible",document.forms.generate.style.display="none"}window.addEventListener("popstate",e=>{if(e.state?.params){const a=m();document.getElementById("output").contentWindow.document.body.innerHTML=a,document.getElementById("output").parentElement.style.visibility="visible",document.forms.generate.style.display="none"}else window.location.reload()});function w(e){e.preventDefault(),document.getElementById("output").contentWindow.print()}function E(e){const t=document.createDocumentFragment(),a=document.getElementById("prefillTemplate");if(e)e.split(",").forEach(d=>{const o=a.content.cloneNode(!0);o.querySelector("input").value=d,t.appendChild(o)});else for(let d=8;d<17;d++){const o=d===12?12:d%12,c=a.content.cloneNode(!0);c.querySelector("input").value=""+o,t.appendChild(c);for(let n=1;n<2;n++)t.appendChild(a.content.cloneNode(!0))}document.getElementById("prefill").appendChild(t)}function k(){const e=new URLSearchParams(window.location.search),t=document.forms.generate,a=t.startDate,d=t.endDate,o=new Date(new Date().toDateString());e.has("startDate")?a.value=e.get("startDate"):a.valueAsDate=o,e.has("endDate")?d.value=e.get("endDate"):(o.setMonth(o.getMonth()+3),d.valueAsDate=o);const c=e.has("activeDays")?e.get("activeDays").split(",").map(n=>n&&n.toLowerCase()==="true"):[!1,!0,!0,!0,!0,!0,!1];t.sunday.checked=c[0],t.monday.checked=c[1],t.tuesday.checked=c[2],t.wednesday.checked=c[3],t.thursday.checked=c[4],t.friday.checked=c[5],t.saturday.checked=c[6],E(e.get("prefill")),document.getElementById("previewBtn").addEventListener("click",f),document.getElementById("printBtn").addEventListener("click",w),document.getElementById("backBtn").addEventListener("click",()=>{window.history.back()}),document.getElementById("addBtn").addEventListener("click",n=>{n.preventDefault(),document.getElementById("prefill").appendChild(document.getElementById("prefillTemplate").content.cloneNode(!0)),l()}),document.getElementById("prefill").addEventListener("click",n=>{n.preventDefault(),n.target.name==="removePrefill"&&(n.target.parentElement.remove(),l())}),document.getElementById("resetBtn").addEventListener("click",n=>{n.preventDefault(),window.history.pushState({},null,window.location.pathname),window.location.reload()}),document.querySelectorAll("input").forEach(n=>{n.addEventListener("input",s=>{l()})})}k();
